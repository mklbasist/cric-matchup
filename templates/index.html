<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cric Matchup</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
</head>
<body style="background:#222; color:white; padding:20px;">

<div class="container">
    <h1 class="text-center">Cric Matchup</h1>

    <div class="form-group">
        <label for="format">Select Format:</label>
        <select id="format" class="form-control">
            <option value="Tests">Tests</option>
        </select>
    </div>

    <div class="form-group">
        <label for="batters_input">Select Batter:</label>
        <input list="batters_list" id="batters_input" class="form-control" oninput="search('batters')" autocomplete="off">
        <datalist id="batters_list"></datalist>
    </div>

    <div class="form-group">
        <label for="bowlers_input">Select Bowler:</label>
        <input list="bowlers_list" id="bowlers_input" class="form-control" oninput="search('bowlers')" autocomplete="off">
        <datalist id="bowlers_list"></datalist>
    </div>

    <button class="btn btn-primary" onclick="getStats()">Get Stats</button>

    <table class="table table-bordered" id="stats_table" style="display:none; margin-top:20px; color: white;">
        <thead>
            <tr>
                <th>Format</th>
                <th>Batter</th>
                <th>Bowler</th>
                <th>Runs</th>
                <th>Balls</th>
                <th>Outs</th>
                <th>Average</th>
                <th>Strike Rate</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td id="format_cell"></td>
                <td id="batter_cell"></td>
                <td id="bowler_cell"></td>
                <td id="runs_cell"></td>
                <td id="balls_cell"></td>
                <td id="outs_cell"></td>
                <td id="average_cell"></td>
                <td id="sr_cell"></td>
            </tr>
        </tbody>
    </table>

    <footer style="text-align:center; padding:10px; margin-top:30px;">
        &copy; 2025 Mukul. All rights reserved.
    </footer>
</div>

<script>
    async function search(type) {
        const query = document.getElementById(type + "_input").value;
        if (query.length === 0) return;
        const res = await fetch(`/${"search_" + type}?query=${query}`);
        const data = await res.json();
        const list = document.getElementById(type + "_list");
        list.innerHTML = "";
        data.forEach(item => {
            const option = document.createElement("option");
            option.value = item;
            list.appendChild(option);
        });
    }

    async function getStats() {
        const format = document.getElementById("format").value;
        const batter = document.getElementById("batters_input").value;
        const bowler = document.getElementById("bowlers_input").value;

        const res = await fetch("/get_stats", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ format, batter, bowler })
        });
        const data = await res.json();

        document.getElementById("stats_table").style.display = "table";
        document.getElementById("format_cell").textContent = data.format;
        document.getElementById("batter_cell").textContent = data.batter;
        document.getElementById("bowler_cell").textContent = data.bowler;
        document.getElementById("runs_cell").textContent = data.runs;
        document.getElementById("balls_cell").textContent = data.balls;
        document.getElementById("outs_cell").textContent = data.outs;
        document.getElementById("average_cell").textContent = data.average;
        document.getElementById("sr_cell").textContent = data.strike_rate;
    }
</script>
</body>
</html>
